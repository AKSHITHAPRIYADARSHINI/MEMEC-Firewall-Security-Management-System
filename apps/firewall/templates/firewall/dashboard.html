{% extends "layouts/base.html" %}

{% block title %}Firewall Management Dashboard{% endblock %}

{% set page_title = "Firewall Management" %}
{% set breadcrumbs = [
  {"title": "Administration", "url": None},
  {"title": "Firewall Management", "url": url_for('firewall_blueprint.dashboard')}
] %}

{% block content %}
<div class="container-fluid py-4">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header pb-0 p-3">
          <h6 class="mb-0">Firewall Management System</h6>
          <p class="text-sm text-secondary mt-2">
            Welcome to the Firewall Management Dashboard. Select an option below to manage your firewall settings.
          </p>
        </div>
        <div class="card-body">
          <!-- Tabs Navigation -->
          <ul class="nav nav-tabs" id="firewallTabs" role="tablist">
            {% if current_user.is_admin() %}
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="config-tab" data-bs-toggle="tab" data-bs-target="#config"
                      type="button" role="tab" aria-controls="config" aria-selected="true">
                <i class="fas fa-cog me-2"></i>Firewall Config
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="access-tab" data-bs-toggle="tab" data-bs-target="#access"
                      type="button" role="tab" aria-controls="access" aria-selected="false">
                <i class="fas fa-shield-alt me-2"></i>Access Control
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="policies-tab" data-bs-toggle="tab" data-bs-target="#policies"
                      type="button" role="tab" aria-controls="policies" aria-selected="false">
                <i class="fas fa-list me-2"></i>Policies
              </button>
            </li>
            {% endif %}

            {% if current_user.is_admin() or current_user.is_lower_admin() %}
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="audit-tab" data-bs-toggle="tab" data-bs-target="#audit"
                      type="button" role="tab" aria-controls="audit" aria-selected="false">
                <i class="fas fa-history me-2"></i>Audit Logs
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="stats-tab" data-bs-toggle="tab" data-bs-target="#stats"
                      type="button" role="tab" aria-controls="stats" aria-selected="false">
                <i class="fas fa-chart-bar me-2"></i>Statistics
              </button>
            </li>
            {% if current_user.is_lower_admin() %}
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="risk-tab" data-bs-toggle="tab" data-bs-target="#risk"
                      type="button" role="tab" aria-controls="risk" aria-selected="false">
                <i class="fas fa-exclamation-triangle me-2"></i>Risk Dashboard
              </button>
            </li>
            {% endif %}
            {% endif %}
          </ul>

          <!-- Tab Content -->
          <div class="tab-content" id="firewallTabContent">
            {% if current_user.is_admin() %}
            <!-- Firewall Configuration Tab -->
            <div class="tab-pane fade show active" id="config" role="tabpanel" aria-labelledby="config-tab">
              <div class="mt-4">
                <h5>Firewall Configuration</h5>
                <p class="text-secondary">Configure your firewall type and network settings.</p>
                <a href="{{ url_for('firewall_blueprint.config') }}" class="btn btn-primary">
                  <i class="fas fa-cog me-2"></i>Manage Configuration
                </a>
              </div>
            </div>

            <!-- Access Control Tab -->
            <div class="tab-pane fade" id="access" role="tabpanel" aria-labelledby="access-tab">
              <div class="mt-4">
                <h5>IP Access Control</h5>
                <p class="text-secondary">Manage IP whitelist and blacklist.</p>
                <a href="{{ url_for('firewall_blueprint.access_control') }}" class="btn btn-primary">
                  <i class="fas fa-shield-alt me-2"></i>Manage Access Control
                </a>
              </div>
            </div>

            <!-- Policies Tab -->
            <div class="tab-pane fade" id="policies" role="tabpanel" aria-labelledby="policies-tab">
              <div class="mt-4">
                <h5>Firewall Policies</h5>
                <p class="text-secondary">Create and manage firewall rules and policies.</p>
                <a href="{{ url_for('firewall_blueprint.policies') }}" class="btn btn-primary">
                  <i class="fas fa-list me-2"></i>Manage Policies
                </a>
              </div>
            </div>
            {% endif %}

            {% if current_user.is_admin() or current_user.is_lower_admin() %}
            <!-- Audit Logs Tab -->
            <div class="tab-pane fade" id="audit" role="tabpanel" aria-labelledby="audit-tab">
              <div class="mt-4">
                <h5>Audit Logs</h5>
                <p class="text-secondary">View comprehensive audit trail of all firewall activities.</p>
                <a href="{{ url_for('firewall_blueprint.audit_logs') }}" class="btn btn-primary">
                  <i class="fas fa-history me-2"></i>View Audit Logs
                </a>
              </div>
            </div>

            <!-- Statistics Tab -->
            <div class="tab-pane fade" id="stats" role="tabpanel" aria-labelledby="stats-tab">
              <div class="mt-4">
                <h5>Statistics & Reports</h5>
                <p class="text-secondary">View firewall statistics and analytics.</p>
                <a href="{{ url_for('firewall_blueprint.statistics') }}" class="btn btn-primary">
                  <i class="fas fa-chart-bar me-2"></i>View Statistics
                </a>
              </div>
            </div>

            {% if current_user.is_lower_admin() %}
            <!-- Risk Dashboard Tab -->
            <div class="tab-pane fade" id="risk" role="tabpanel" aria-labelledby="risk-tab">
              <div class="mt-4">
                <h5>Risk Dashboard</h5>
                <p class="text-secondary">Monitor threats and unauthorized access attempts.</p>
                <a href="{{ url_for('firewall_blueprint.risk_dashboard') }}" class="btn btn-primary">
                  <i class="fas fa-exclamation-triangle me-2"></i>View Risk Dashboard
                </a>
              </div>
            </div>
            {% endif %}
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}
